#!/bin/bash
set -e

echo "üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞—á–∞—Ç–∞..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /root

# –ò–∑–≤–ª–µ–∫–∞–µ–º –∞—Ä—Ö–∏–≤
echo "üì¶ –ò–∑–≤–ª–µ–∫–∞–µ–º –∞—Ä—Ö–∏–≤..."
tar -xzf tlbot-deploy.tar.gz

# –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–µ—Ä–≤–µ—Ä–∞
echo "‚öôÔ∏è –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–µ—Ä–≤–µ—Ä–∞..."
chmod +x quick-setup.sh
./quick-setup.sh

echo "‚úÖ –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è tlbot –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç
echo "üë§ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è tlbot..."
su - tlbot << 'TLBOT_EOF'
set -e

# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
mkdir -p /home/tlbot/app

# –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
sudo cp -r /root/* /home/tlbot/app/ 2>/dev/null || true
cd /home/tlbot/app

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞
sudo chown -R tlbot:tlbot /home/tlbot/app

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x *.sh 2>/dev/null || true

echo "üìã –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ /home/tlbot/app"
echo "üöÄ –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é!"

TLBOT_EOF

echo "üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "======================================="
echo "üìÅ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤: /home/tlbot/app"
echo "üë§ –î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"
echo "   su - tlbot"
echo "   cd /home/tlbot/app"
echo "   ./deploy-regoblako.sh"


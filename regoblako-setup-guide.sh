#!/bin/bash

# üåê –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–µ–ø–ª–æ—è –Ω–∞ —Ä–µ–≥.–æ–±–ª–∞–∫–æ VPS
# IP: 89.104.65.237

echo "üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é TL Bot –Ω–∞ —Ä–µ–≥.–æ–±–ª–∞–∫–æ"
echo "============================================="
echo ""
echo "üìã –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:"
echo "IP —Å–µ—Ä–≤–µ—Ä–∞: 89.104.65.237"
echo "–û–°: Ubuntu 24.04 LTS"
echo "RAM: 1 –ì–ë"
echo "Telegram Bot Token: 7482550053:AAEd0XzEb3tkL1pryqkMYXn1YhoqJaMD7N0"
echo ""

# –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
echo "üì° –®–ê–ì 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É"
echo "==============================="
echo "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:"
echo ""
echo "# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:"
echo "scp tlbot-deploy.tar.gz root@89.104.65.237:/root/"
echo ""
echo "# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:"
echo "ssh root@89.104.65.237"
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É..."

# –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
echo ""
echo "‚öôÔ∏è  –®–ê–ì 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞"
echo "============================"
echo "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"
echo ""
echo "# –ò–∑–≤–ª–µ–∫–∏—Ç–µ –∞—Ä—Ö–∏–≤:"
echo "cd /root"
echo "tar -xzf tlbot-deploy.tar.gz"
echo ""
echo "# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫—É:"
echo "chmod +x quick-setup.sh"
echo "./quick-setup.sh"
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞..."

# –®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
echo ""
echo "üì¶ –®–ê–ì 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞"
echo "============================"
echo "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"
echo ""
echo "# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è tlbot:"
echo "su - tlbot"
echo ""
echo "# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:"
echo "sudo cp -r /root/* /home/tlbot/app/ 2>/dev/null || true"
echo "cd /home/tlbot/app"
echo "sudo chown -R tlbot:tlbot /home/tlbot/app"
echo ""
echo "# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ñ–∞–π–ª —É–∂–µ –≥–æ—Ç–æ–≤):"
echo "cp .env.regoblako .env.production"
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ñ–∞–π–ª–æ–≤..."

# –®–∞–≥ 4: –î–µ–ø–ª–æ–π
echo ""
echo "üöÄ –®–ê–ì 4: –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è"
echo "======================"
echo "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"
echo ""
echo "# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π –¥–ª—è —Ä–µ–≥.–æ–±–ª–∞–∫–æ:"
echo "chmod +x deploy-regoblako.sh"
echo "./deploy-regoblako.sh"
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è..."

# –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram
echo ""
echo "ü§ñ –®–ê–ì 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot"
echo "================================"
echo "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:"
echo ""
echo "# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook:"
echo "curl -F \"url=http://89.104.65.237:3000/api/bot\" \\"
echo "     \"https://api.telegram.org/bot7482550053:AAEd0XzEb3tkL1pryqkMYXn1YhoqJaMD7N0/setWebhook\""
echo ""
echo "# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook:"
echo "curl \"https://api.telegram.org/bot7482550053:AAEd0XzEb3tkL1pryqkMYXn1YhoqJaMD7N0/getWebhookInfo\""
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook..."

# –§–∏–Ω–∞–ª
echo ""
echo "üéâ –ì–û–¢–û–í–û!"
echo "=========="
echo ""
echo "üåê –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å–∞–º:"
echo "   –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://89.104.65.237:3000"
echo "   –ê–¥–º–∏–Ω–∫–∞: http://89.104.65.237:3000/admin"
echo "   Health check: http://89.104.65.237:3000/api/health"
echo ""
echo "üë§ –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É:"
echo "   Email: admin@tlbot.local"
echo "   –ü–∞—Ä–æ–ª—å: AdminTLBot2025!"
echo ""
echo "üì± –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start"
echo ""
echo "üõ†Ô∏è  –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:"
echo "   –°—Ç–∞—Ç—É—Å: docker-compose -f docker-compose.regoblako.yml ps"
echo "   –õ–æ–≥–∏: docker-compose -f docker-compose.regoblako.yml logs -f app"
echo "   –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫: docker-compose -f docker-compose.regoblako.yml restart app"
echo ""
echo "üîÑ –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:"
echo "   ./deploy-regoblako.sh"
